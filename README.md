# Applied Deep learning 

## Layout of the repository 
This repository consists of 
- A few images of the dataset along with the folder structure of the dataset handled whithin the code. 
- Folder of the helper functions for running the main code. 
- Folder of the predictions generated by the model trained. 

## Segmentation based Bee detection
This code returns output in 3 images - 
1. Segmentation map of the body and abdomen of the bees. 
2. Comparison of the predictions and the ground truth labels 
3. Information regarding the True positives, false positives and the false negatives. 

## Dataset
This code is prepared for the beehive dataset that can be found in the website - [BeeHive Dataset](https://groups.oist.jp/bptu/honeybee-tracking-dataset)
The dataset is stored in the local drive as per the below format - 
```
dataset
+-- frames  
|   +-- *.png  
+-- frames_txt  
|   +-- *.txt 
+-- training_config.json
```
The training_config.json file has the information regarding the test-train split up.
## Software requirements
- Tensorflow (tested on 1.15)
- OpenCV (3) 
- Numpy
- Python (3.6)

## Training results
The Unet model was trained with the training data as mentioned in the training_config.json file. The Unet has been trained for 1000 steps with a training loss of 0.08

## Evaluation of the model 

True Positives - 88.45% 
False negatives - 11.55% 
False positives - 5.79% 
Average Precision - 97.66% 

Segmented output - 

<img src="https://github.com/kartikshekhar/Bee_Segmentation/blob/main/predict_result/frame_30fps_002115_seg_map.png" alt="drawing" width="40%"/>

The reds represent the abdomen of the bee and the blue represents the body of the bee.

Comparison of predictions and labels - 

<img src="https://github.com/kartikshekhar/Bee_Segmentation/blob/main/predict_result/frame_30fps_002115_mixed.png" alt="drawing" width="40%"/>

Predictions in red. Labels in yellow. 

Representation of True positive, False positives and false negatives - 

<img src="https://github.com/kartikshekhar/Bee_Segmentation/blob/main/predict_result/frame_30fps_002115_detail.png" alt="drawing" width="40%"/>

True Positive in green. False positives in yellow. False negatives in red. 
